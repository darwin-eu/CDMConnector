[{"path":[]},{"path":"/CONTRIBUTING.html","id":"filing-issues","dir":"","previous_headings":"","what":"Filing issues","title":"Contributing to CDMConnector","text":"found bug, question, want suggest new feature please open issue. reporting bug, reprex much appreciated.","code":""},{"path":"/CONTRIBUTING.html","id":"contributing-code-or-documentation","dir":"","previous_headings":"","what":"Contributing code or documentation","title":"Contributing to CDMConnector","text":"package developed part DARWIN EU(R) project closed external contributions. contributing either documentation code, please make sure open issue beforehand identify needs done .","code":""},{"path":"/CONTRIBUTING.html","id":"documenting-the-package","dir":"","previous_headings":"Contributing code or documentation","what":"Documenting the package","title":"Contributing to CDMConnector","text":"Run update check package documentation: Note devtools::check_man() return warnings. commit limited package documentation, running sufficient (although running devtools::check() always generally good idea submitting pull request.","code":"devtools::document()  devtools::run_examples() devtools::build_readme() devtools::build_vignettes() devtools::check_man()"},{"path":"/CONTRIBUTING.html","id":"run-tests","dir":"","previous_headings":"Contributing code or documentation","what":"Run tests","title":"Contributing to CDMConnector","text":"starting contribute code, first make sure package tests passing. raise issue going (although please first make sure packages imports suggests installed). contribute code, make sure current tests add continue pass. package tests can run together : Code add new functionality accompanied tests. Code coverage can checked using:","code":"devtools::test() # note, you may first have to detach the package # detach(\"package:IncidencePrevalence\", unload=TRUE) devtools::test_coverage()"},{"path":"/CONTRIBUTING.html","id":"adhere-to-code-style","dir":"","previous_headings":"Contributing code or documentation","what":"Adhere to code style","title":"Contributing to CDMConnector","text":"Please adhere code style adding new code. though restyle code unrelated pull request make code review difficult.","code":"lintr::lint_package(\".\",                     linters = lintr::linters_with_defaults(                       lintr::object_name_linter(styles = \"camelCase\")                     ) )"},{"path":"/CONTRIBUTING.html","id":"run-check-before-opening-a-pull-request","dir":"","previous_headings":"Contributing code or documentation","what":"Run check() before opening a pull request","title":"Contributing to CDMConnector","text":"opening pull request please make sure run: warnings seen. package CRAN close submitted CRAN please also run: Also can worth checking spelling urls","code":"devtools::check() rcmdcheck::rcmdcheck(args = c(\"--no-manual\", \"--as-cran\")) devtools::check_win_devel() spelling::spell_check_package() urlchecker::url_check()"},{"path":"/articles/a01_getting-started.html","id":"creating-a-reference-to-the-omop-cdm","dir":"Articles","previous_headings":"","what":"Creating a reference to the OMOP CDM","title":"Getting Started","text":"CDMConnector package provides tools working OMOP Common Data Model (CDM) tables using familiar dplyr syntax. connecting database containing data mapped OMOP CDM, can use cdm_from_con CDMConnector create CDM reference. CDM reference single object contains table references along specific metadata. example, ’ll use Eunomia data contained duckdb database. First, haven’t previously done , need download data. downloaded, add path Renviron. Eunomia data now downloaded, can connect database create reference. Individual CDM table references can accessed using $ piped dplyr verbs.","code":"library(CDMConnector) library(dplyr) downloadEunomiaData(   pathToData = here::here(), # change to the location you want to save the data   overwrite = TRUE ) # once downloaded, save path to your Renviron: EUNOMIA_DATA_FOLDER=\"......\" # (and then restart R) con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con, cdm_schema = \"main\") cdm #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: person, observation_period, visit_occurrence, condition_occurrence, drug_exposure, procedure_occurrence, measurement, observation, death, location, care_site, provider, drug_era, dose_era, condition_era, cdm_source, concept, vocabulary, concept_relationship, concept_synonym, concept_ancestor, drug_strength cdm$person %>%    glimpse() #> Rows: ?? #> Columns: 18 #> Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//RtmpVmlANb/binaimoj] #> $ person_id                   <dbl> 6, 123, 129, 16, 65, 74, 42, 187, 18, 111,… #> $ gender_concept_id           <dbl> 8532, 8507, 8507, 8532, 8532, 8532, 8532, … #> $ year_of_birth               <dbl> 1963, 1950, 1974, 1971, 1967, 1972, 1909, … #> $ month_of_birth              <dbl> 12, 4, 10, 10, 3, 1, 11, 7, 11, 5, 8, 3, 3… #> $ day_of_birth                <dbl> 31, 12, 7, 13, 31, 5, 2, 23, 17, 2, 19, 13… #> $ birth_datetime              <dttm> 1963-12-31, 1950-04-12, 1974-10-07, 1971-… #> $ race_concept_id             <dbl> 8516, 8527, 8527, 8527, 8516, 8527, 8527, … #> $ ethnicity_concept_id        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, … #> $ location_id                 <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ provider_id                 <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ care_site_id                <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA… #> $ person_source_value         <chr> \"001f4a87-70d0-435c-a4b9-1425f6928d33\", \"0… #> $ gender_source_value         <chr> \"F\", \"M\", \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F… #> $ gender_source_concept_id    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, … #> $ race_source_value           <chr> \"black\", \"white\", \"white\", \"white\", \"black… #> $ race_source_concept_id      <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, … #> $ ethnicity_source_value      <chr> \"west_indian\", \"italian\", \"polish\", \"ameri… #> $ ethnicity_source_concept_id <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …"},{"path":"/articles/a01_getting-started.html","id":"selecting-a-subset-of-cdm-tables","dir":"Articles","previous_headings":"","what":"Selecting a subset of CDM tables","title":"Getting Started","text":"need references tables can easily select subset tables include CDM reference. cdm_tables argument cdm_from_con supports tidyselect selection language provides new selection helper: tbl_group. Predefined sets tables can also selected using tbl_group supports several subsets CDM: “”, “clinical”, “vocab”, “derived”, “default”. default set CDM tables included CDM object :","code":"cdm_from_con(con, cdm_tables = c(\"person\", \"observation_period\")) # character vector #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: person, observation_period cdm_from_con(con, cdm_tables = starts_with(\"concept\")) # tables that start with 'concept' #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: concept, concept_class, concept_relationship, concept_synonym, concept_ancestor cdm_from_con(con, cdm_tables = contains(\"era\")) # tables that contain the substring 'era' #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: drug_era, dose_era, condition_era cdm_from_con(con, cdm_tables = matches(\"person|period\")) # regular expression #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: person, observation_period, payer_plan_period # pre-defined groups cdm_from_con(con, cdm_tables = tbl_group(\"clinical\"))  #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: person, observation_period, visit_occurrence, visit_detail, condition_occurrence, drug_exposure, procedure_occurrence, device_exposure, measurement, observation, death, note, note_nlp, specimen, fact_relationship cdm_from_con(con, cdm_tables = tbl_group(\"vocab\"))  #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: concept, vocabulary, domain, concept_class, concept_relationship, relationship, concept_synonym, concept_ancestor, source_to_concept_map, drug_strength tbl_group(\"default\") #>  [1] \"person\"               \"observation_period\"   \"visit_occurrence\"     #>  [4] \"condition_occurrence\" \"drug_exposure\"        \"procedure_occurrence\" #>  [7] \"measurement\"          \"observation\"          \"death\"                #> [10] \"location\"             \"care_site\"            \"provider\"             #> [13] \"drug_era\"             \"dose_era\"             \"condition_era\"        #> [16] \"cdm_source\"           \"concept\"              \"vocabulary\"           #> [19] \"concept_relationship\" \"concept_synonym\"      \"concept_ancestor\"     #> [22] \"drug_strength\""},{"path":"/articles/a01_getting-started.html","id":"including-existing-cohort-tables-in-the-cdm-reference","dir":"Articles","previous_headings":"","what":"Including existing cohort tables in the CDM reference","title":"Getting Started","text":"common use one cohort tables along CDM. can include existing cohort tables specifying schema reside name like :","code":"cdm <- cdm_from_con(con,                      cdm_tables = c(\"person\", \"observation_period\"),                      write_schema = \"write_schema\",                     cohort_tables = \"cohort\")   cdm$cohort #> # Source:   table<write_schema.cohort> [2 x 4] #> # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//RtmpVmlANb/binaimoj] #>   cohort_definition_id subject_id cohort_start_date cohort_end_date #>                  <int>      <int> <date>            <date>          #> 1                    1          1 2023-03-20        2023-03-20      #> 2                    1          2 2020-02-03        2020-11-04"},{"path":"/articles/a01_getting-started.html","id":"extracting-data","dir":"Articles","previous_headings":"","what":"Extracting data","title":"Getting Started","text":"two ways extract subsets CDM. collect pulls data R stow saves cdm subset set files disk either parquet, feather, csv format Note, either case, think carefully data extracting make sure get data require (fit memory!)","code":"local_cdm <- cdm %>%    collect()  # The cdm tables are now dataframes local_cdm$person[1:4, 1:4]  #> # A tibble: 4 × 4 #>   person_id gender_concept_id year_of_birth month_of_birth #>       <dbl>             <dbl>         <dbl>          <dbl> #> 1         6              8532          1963             12 #> 2       123              8507          1950              4 #> 3       129              8507          1974             10 #> 4        16              8532          1971             10 save_path <- file.path(tempdir(), \"tmp\") dir.create(save_path)  cdm %>%    stow(path = save_path)  list.files(save_path) #> [1] \"cohort.parquet\"             \"observation_period.parquet\" #> [3] \"person.parquet\""},{"path":"/articles/a01_getting-started.html","id":"closing-connections","dir":"Articles","previous_headings":"","what":"Closing connections","title":"Getting Started","text":"Close database connection dbDisconnect. connection closed cdm object can longer used.","code":"DBI::dbDisconnect(con, shutdown = TRUE)"},{"path":"/articles/a02_Working_with_cohorts.html","id":"adding-a-cohort","dir":"Articles","previous_headings":"","what":"Adding a cohort","title":"Working with cohorts","text":"First, ’ll load packages create cdm reference. case ’ll using Eunomia “GI Bleed” dataset. can define cohort GI bleeding, exclude anyone record rheumatoid arthritis time. Now cohort definition, can generate cohort. can see now cohort instantiated database reference added cdm reference.","code":"library(CDMConnector) library(dplyr)  con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir())  cdm <- CDMConnector::cdm_from_con(   con = con,   cdm_schema = \"main\",   write_schema = \"main\" ) # devtools::install_github(\"OHDSI/Capr\", \"v2\") # Use the development version of Capr v2 library(Capr)  # create a cohort set folder for saving cohort definitions path <- file.path(tempdir(), \"cohorts\") dir.create(path)  gibleed_cohort_definition <- cohort(   entry = condition(cs(descendants(192671))),   attrition = attrition(     \"no RA\" = withAll(       exactly(0,               condition(cs(descendants(80809))),               duringInterval(eventStarts(-Inf, Inf))))   ) )  # write json cohort definition writeCohort(gibleed_cohort_definition, file.path(path, \"gibleed.json\")) gibleed_cohort_set <- readCohortSet(path = path) # requires CirceR optional dependency cdm <- generateCohortSet(   cdm,   gibleed_cohort_set,   name = \"gibleed\",   computeAttrition = TRUE ) cdm$gibleed %>%    glimpse() #> Rows: 237 #> Columns: 4 #> $ cohort_definition_id <int> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3… #> $ subject_id           <dbl> 3, 32, 80, 133, 187, 188, 202, 260, 264, 273, 285… #> $ cohort_start_date    <date> 1958-01-29, 1987-06-09, 1974-10-27, 2019-04-05, … #> $ cohort_end_date      <date> 2018-10-29, 2014-12-24, 2019-04-15, 2019-04-06, …"},{"path":"/articles/a02_Working_with_cohorts.html","id":"cohort-attributes","dir":"Articles","previous_headings":"","what":"Cohort attributes","title":"Working with cohorts","text":"well cohort , cohort number attributes. First, count participants cohort. can use cohortCount get counts. also attrition associated entry cohort available via cohortAttrition. lastly, can also access settings associated cohort using cohortCount.","code":"cohortCount(cdm$gibleed) %>%    glimpse() #> Rows: 1 #> Columns: 3 #> $ cohort_definition_id <int> 3 #> $ cohort_entries       <dbl> 237 #> $ cohort_subjects      <dbl> 237 cohortAttrition(cdm$gibleed) %>%    glimpse() #> Rows: 1 #> Columns: 7 #> $ cohort_definition_id <int> 3 #> $ number_records       <dbl> 237 #> $ number_subjects      <dbl> 237 #> $ reason_id            <dbl> 1 #> $ reason               <chr> \"Qualifying initial records\" #> $ excluded_records     <dbl> 0 #> $ excluded_subjects    <dbl> 0 cohortSet(cdm$gibleed) %>%    glimpse() #> Rows: 1 #> Columns: 2 #> $ cohort_definition_id <int> 3 #> $ cohort_name          <chr> \"GIBleed_male\" DBI::dbDisconnect(con, shutdown = TRUE)"},{"path":"/articles/a03_dbplyr.html","id":"set-up","dir":"Articles","previous_headings":"","what":"Set up","title":"CDMConnector and dbplyr","text":"First let’s load required packages code vignette. haven’t already installed , packages can installed using ´install.packages()´","code":"library(CDMConnector) library(dplyr, warn.conflicts = FALSE) library(ggplot2)"},{"path":"/articles/a03_dbplyr.html","id":"creating-the-cdm-reference","dir":"Articles","previous_headings":"","what":"Creating the cdm reference","title":"CDMConnector and dbplyr","text":"Now let´s connect duckdb database Eunomia data (https://github.com/OHDSI/Eunomia). cdm object now ´ll use going forward. provides reference OMOP CDM tables. can see tables still database, now reference ones might want use analysis. example, person table can referenced like ","code":"con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con, cdm_schema = \"main\") cdm #> # OMOP CDM reference (tbl_duckdb_connection) #>  #> Tables: person, observation_period, visit_occurrence, condition_occurrence, drug_exposure, procedure_occurrence, measurement, observation, death, location, care_site, provider, drug_era, dose_era, condition_era, cdm_source, concept, vocabulary, concept_relationship, concept_synonym, concept_ancestor, drug_strength"},{"path":"/articles/a03_dbplyr.html","id":"putting-it-all-together","dir":"Articles","previous_headings":"","what":"Putting it all together","title":"CDMConnector and dbplyr","text":"Say want make histogram year birth person table. can select variable, bring memory, use ggplot make histogram.  wanted make boxplot length observation periods computation database side, bring new variable memory, use ggplot produce boxplot","code":"cdm$person %>%   select(year_of_birth) %>%   collect() %>%   ggplot(aes(x = year_of_birth)) +   geom_histogram(bins = 30) cdm$observation_period %>%   select(observation_period_start_date, observation_period_end_date) %>%   mutate(observation_period = (observation_period_end_date - observation_period_start_date)/365, 25) %>%   select(observation_period) %>%   collect() %>%   ggplot(aes(x = observation_period)) +   geom_boxplot()"},{"path":"/articles/a03_dbplyr.html","id":"behind-the-scenes","dir":"Articles","previous_headings":"","what":"Behind the scenes","title":"CDMConnector and dbplyr","text":"use show_query check sql run duckdb","code":"cdm$person %>%   tally() %>%   show_query() #> <SQL> #> SELECT COUNT(*) AS n #> FROM main.person cdm$person %>%   summarise(median(year_of_birth))%>%   show_query() #> Warning: Missing values are always removed in SQL aggregation functions. #> Use `na.rm = TRUE` to silence this warning #> This warning is displayed once every 8 hours. #> <SQL> #> SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY year_of_birth) AS \"median(year_of_birth)\" #> FROM main.person cdm$person %>%   mutate(gender = case_when(     gender_concept_id == \"8507\" ~ \"Male\",     gender_concept_id == \"8532\" ~ \"Female\",     TRUE ~ NA_character_))%>%   show_query() #> <SQL> #> SELECT #>   *, #>   CASE #> WHEN (gender_concept_id = '8507') THEN 'Male' #> WHEN (gender_concept_id = '8532') THEN 'Female' #> ELSE NULL #> END AS gender #> FROM main.person DBI::dbDisconnect(con, shutdown = TRUE)"},{"path":"/articles/a04_DBI_connection_examples.html","id":"postgres","dir":"Articles","previous_headings":"","what":"Postgres","title":"DBI connection examples","text":"","code":"con <- DBI::dbConnect(RPostgres::Postgres(),                       dbname = Sys.getenv(\"CDM5_POSTGRESQL_DBNAME\"),                       host = Sys.getenv(\"CDM5_POSTGRESQL_HOST\"),                       user = Sys.getenv(\"CDM5_POSTGRESQL_USER\"),                       password = Sys.getenv(\"CDM5_POSTGRESQL_PASSWORD\"))  cdm <- cdm_from_con(con, cdm_schema = Sys.getenv(\"CDM5_POSTGRESQL_CDM_SCHEMA\"), select = tbl_group(\"vocab\")) DBI::dbDisconnect(con)"},{"path":"/articles/a04_DBI_connection_examples.html","id":"sql-server","dir":"Articles","previous_headings":"","what":"SQL Server","title":"DBI connection examples","text":"Using odbc SQL Server requires driver setup described .","code":"con <- DBI::dbConnect(odbc::odbc(),                       Driver   = \"ODBC Driver 18 for SQL Server\",                       Server   = Sys.getenv(\"CDM5_SQL_SERVER_SERVER\"),                       Database = Sys.getenv(\"CDM5_SQL_SERVER_CDM_DATABASE\"),                       UID      = Sys.getenv(\"CDM5_SQL_SERVER_USER\"),                       PWD      = Sys.getenv(\"CDM5_SQL_SERVER_PASSWORD\"),                       TrustServerCertificate=\"yes\",                       Port     = 1433)  cdm <- cdm_from_con(con, cdm_schema = c(\"CDMV5\", \"dbo\"), select = tbl_group(\"vocab\")) DBI::dbDisconnect(con)"},{"path":"/articles/a04_DBI_connection_examples.html","id":"redshift","dir":"Articles","previous_headings":"","what":"Redshift","title":"DBI connection examples","text":"Redshift almost identical Postgres.","code":"con <- DBI::dbConnect(RPostgres::Redshift(),                       dbname   = Sys.getenv(\"CDM5_REDSHIFT_DBNAME\"),                       host     = Sys.getenv(\"CDM5_REDSHIFT_HOST\"),                       port     = Sys.getenv(\"CDM5_REDSHIFT_PORT\"),                       user     = Sys.getenv(\"CDM5_REDSHIFT_USER\"),                       password = Sys.getenv(\"CDM5_REDSHIFT_PASSWORD\"))  cdm <- cdm_from_con(con, cdm_schema = Sys.getenv(\"CDM5_REDSHIFT_CDM_SCHEMA\"), select = tbl_group(\"vocab\")) DBI::dbDisconnect(con)"},{"path":"/articles/a05_cdm_reference_backends.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"CDM reference backends","text":"CDMConnector package allows us work cdm data different locations consistently. cdm_reference may tables database, files disk, tables loaded R. allows computation take place wherever convenient. schematic CDMConnector can used create cdm_references different locations.","code":""},{"path":"/articles/a05_cdm_reference_backends.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"CDM reference backends","text":"show can work (slightly overcomplicate things show different options), let´s say want create histogram age patients diagnosis tear meniscus knee (concept_id “4035415”). can start database , loading required packages, subset person table people include people condition_occurrence table condition_concept_id “4035415” can save tables file now can create cdm_reference files create age diagnosis variable can bring result R make histogram","code":"library(CDMConnector) library(dplyr, warn.conflicts = FALSE) library(ggplot2) con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con, cdm_schema = \"main\", cdm_tables = c(\"person\", \"condition_occurrence\"))  # first filter to only those with condition_concept_id \"4035415\" cdm$condition_occurrence %>% tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmp46tAah/iylfhagt] #>       n #>   <dbl> #> 1 65332  cdm$condition_occurrence <- cdm$condition_occurrence %>%   filter(condition_concept_id == \"4035415\") %>%   select(person_id, condition_start_date)  cdm$condition_occurrence %>% tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmp46tAah/iylfhagt] #>       n #>   <dbl> #> 1    83  # then left_join person table cdm$person %>% tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmp46tAah/iylfhagt] #>       n #>   <dbl> #> 1  2694 cdm$person <- cdm$condition_occurrence %>%   select(person_id) %>%   left_join(select(cdm$person, person_id, year_of_birth), by = \"person_id\")  cdm$person %>% tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmp46tAah/iylfhagt] #>       n #>   <dbl> #> 1    83 dOut <- tempfile() dir.create(dOut) CDMConnector::stow(cdm, dOut) cdm_arrow <- cdm_from_files(dOut, as_data_frame = FALSE)  cdm_arrow$person %>%   nrow() #> [1] 83  cdm_arrow$condition_occurrence %>%   nrow() #> [1] 83 cdm_arrow$result <- cdm_arrow$person %>%   left_join(cdm_arrow$condition_occurrence, by = \"person_id\") %>%   mutate(age_diag = year(condition_start_date) - year_of_birth) result <- cdm_arrow$result %>%   collect()  str(result) #> tibble [85 × 4] (S3: tbl_df/tbl/data.frame) #>  $ person_id           : num [1:85] 430 458 372 452 165 459 99 66 161 145 ... #>  $ year_of_birth       : num [1:85] 1931 1972 1961 1962 1968 ... #>  $ condition_start_date: Date[1:85], format: \"1997-12-05\" \"2010-06-25\" ... #>  $ age_diag            : num [1:85] 66 38 57 51 45 14 10 58 39 25 ...  result %>%   ggplot(aes(age_diag)) +   geom_histogram() DBI::dbDisconnect(con, shutdown = TRUE)"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Adam Black. Author, maintainer. Artem Gorbachev. Author. Edward Burn. Author. Marti Catala Sabate. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Black , Gorbachev , Burn E, Catala Sabate M (2023). CDMConnector: Connect OMOP Common Data Model. R package version 0.5.1.","code":"@Manual{,   title = {CDMConnector: Connect to an OMOP Common Data Model},   author = {Adam Black and Artem Gorbachev and Edward Burn and Marti {Catala Sabate}},   year = {2023},   note = {R package version 0.5.1}, }"},{"path":"/index.html","id":"cdmconnector","dir":"","previous_headings":"","what":"Connect to an OMOP Common Data Model","title":"Connect to an OMOP Common Data Model","text":"using tidyverse OMOP Common Data Model? Interact CDM pipe-friendly way CDMConnector. Quickly connect CDM start exploring. Build data analysis pipelines using familiar dplyr verbs. Easily extract subsets CDM data database.","code":""},{"path":"/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Connect to an OMOP Common Data Model","text":"CDMConnector introduces single R object represents OMOP CDM relational database inspired dm, DatabaseConnector, Andromeda packages. cdm object can used dplyr style data analysis pipelines facilitates interactive data exploration. cdm objects encapsulate references OMOP CDM tables remote RDBMS well metadata necessary interacting CDM.","code":""},{"path":"/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Connect to an OMOP Common Data Model","text":"CDMConnector meant entry point composable tidyverse style data analysis operations OMOP CDM. cdm_reference object behaves like named list tables. Quickly create list references subset CDM tables Store connection information later use inside functions Use DBI driver back-end OMOP CDM See Getting started details.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Connect to an OMOP Common Data Model","text":"CDMConnector can installed CRAN: development version can installed GitHub:","code":"install.packages(\"CDMConnector\") # install.packages(\"devtools\") devtools::install_github(\"darwin-eu/CDMConnector\")"},{"path":"/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Connect to an OMOP Common Data Model","text":"Create cdm_reference object DBI connection. Use `cdm_schema argument point particular schema database. cdm_reference named list table references: Use dplyr verbs table references. Compose operations pipe. Run simple quality check cdm.","code":"library(CDMConnector)  con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con, cdm_schema = \"main\") cdm  ## # OMOP CDM reference (tbl_duckdb_connection) ##  ## Tables: person, observation_period, visit_occurrence, condition_occurrence, drug_exposure, procedure_occurrence, measurement, observation, death, location, care_site, provider, drug_era, dose_era, condition_era, cdm_source, concept, vocabulary, concept_relationship, concept_synonym, concept_ancestor, drug_strength library(dplyr, warn.conflicts = FALSE) names(cdm)  ##  [1] \"person\"               \"observation_period\"   \"visit_occurrence\"     ##  [4] \"condition_occurrence\" \"drug_exposure\"        \"procedure_occurrence\" ##  [7] \"measurement\"          \"observation\"          \"death\"                ## [10] \"location\"             \"care_site\"            \"provider\"             ## [13] \"drug_era\"             \"dose_era\"             \"condition_era\"        ## [16] \"cdm_source\"           \"concept\"              \"vocabulary\"           ## [19] \"concept_relationship\" \"concept_synonym\"      \"concept_ancestor\"     ## [22] \"drug_strength\" tally(cdm$person)  ## # Source:   SQL [1 x 1] ## # Database: DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmpk913PZ/giloosuw] ##       n ##   <dbl> ## 1  2694 cdm$condition_era %>%   left_join(cdm$concept, by = c(\"condition_concept_id\" = \"concept_id\")) %>%    count(top_conditions = concept_name, sort = TRUE)  ## # Source:     SQL [?? x 2] ## # Database:   DuckDB 0.6.1 [root@Darwin 21.6.0:R 4.2.2//var/folders/xx/01v98b6546ldnm1rg1_bvk000000gn/T//Rtmpk913PZ/giloosuw] ## # Ordered by: desc(n) ##    top_conditions                               n ##    <chr>                                    <dbl> ##  1 Viral sinusitis                          17268 ##  2 Acute viral pharyngitis                  10217 ##  3 Acute bronchitis                          8184 ##  4 Otitis media                              3561 ##  5 Osteoarthritis                            2694 ##  6 Streptococcal sore throat                 2656 ##  7 Sprain of ankle                           1915 ##  8 Concussion with no loss of consciousness  1013 ##  9 Sinusitis                                 1001 ## 10 Acute bacterial sinusitis                  939 ## # … with more rows cdm <- cdm_from_con(con, cdm_tables = c(\"person\", \"observation_period\")) validate_cdm(cdm)  ## ── CDM v5.3 validation (checking 2 tables) ───────────────────────────────────── ## ✔ cdm field names are correct ## ✔ all row counts > 0"},{"path":"/index.html","id":"dbi-drivers","dir":"","previous_headings":"","what":"DBI Drivers","title":"Connect to an OMOP Common Data Model","text":"CDMConnector tested using following DBI driver backends: RPostgres Postgres Redshift odbc Microsoft SQL Server Databricks/Spark duckdb","code":""},{"path":"/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting help","title":"Connect to an OMOP Common Data Model","text":"encounter clear bug, please file issue minimal reproducible example GitHub. License: Apache 2.0","code":""},{"path":"/reference/CDMConnector-package.html","id":null,"dir":"Reference","previous_headings":"","what":"CDMConnector: Connect to an OMOP Common Data Model — CDMConnector-package","title":"CDMConnector: Connect to an OMOP Common Data Model — CDMConnector-package","text":"Provides tools working observational health data Observational Medical Outcomes Partnership (OMOP) Common Data Model format pipe friendly syntax. Common data model database table references stored single compound object along metadata.","code":""},{"path":"/reference/CDMConnector-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"CDMConnector: Connect to an OMOP Common Data Model — CDMConnector-package","text":"Maintainer: Adam Black black@ohdsi.org (ORCID) Authors: Artem Gorbachev artem.gorbachev@odysseusinc.com Edward Burn edward.burn@ndorms.ox.ac.uk Marti Catala Sabate marti.catalasabate@ndorms.ox.ac.uk","code":""},{"path":"/reference/appendPermanent.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a dplyr query and add the result set to an existing — appendPermanent","title":"Run a dplyr query and add the result set to an existing — appendPermanent","text":"Run dplyr query add result set existing","code":""},{"path":"/reference/appendPermanent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a dplyr query and add the result set to an existing — appendPermanent","text":"","code":"appendPermanent(x, name, schema = NULL)  append_permanent(x, name, schema = NULL)"},{"path":"/reference/appendPermanent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a dplyr query and add the result set to an existing — appendPermanent","text":"x dplyr query name Name table appended. already exist created. schema Schema table exists. Can length 1 2 vector. (e.g. schema = \"my_schema\", schema = c(\"my_schema\", \"dbo\"))","code":""},{"path":"/reference/appendPermanent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a dplyr query and add the result set to an existing — appendPermanent","text":"dplyr reference newly created table","code":""},{"path":"/reference/appendPermanent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run a dplyr query and add the result set to an existing — appendPermanent","text":"","code":"if (FALSE) { library(CDMConnector)  con <- DBI::dbConnect(duckdb::duckdb(), dbdir = CDMConnector::eunomia_dir()) concept <- dplyr::tbl(con, \"concept\")  # create a table rxnorm_count <- concept %>%   dplyr::filter(domain_id == \"Drug\") %>%   dplyr::mutate(isRxnorm = (vocabulary_id == \"RxNorm\")) %>%   dplyr::count(domain_id, isRxnorm) %>%   computeQu(\"rxnorm_count\")  # append to an existing table rxnorm_count <- concept %>%   dplyr::filter(domain_id == \"Procedure\") %>%   dplyr::mutate(isRxnorm = (vocabulary_id == \"RxNorm\")) %>%   dplyr::count(domain_id, isRxnorm) %>%   appendPermanent(\"rxnorm_count\")  DBI::dbDisconnect(con, shutdown = TRUE)  }"},{"path":"/reference/asDate.html","id":null,"dir":"Reference","previous_headings":"","what":"as.Date dbplyr translation wrapper — asDate","title":"as.Date dbplyr translation wrapper — asDate","text":"workaround using .Date inside dplyr verbs database backend. function used inside dplyr verbs first argument database table reference. asDate must unquoted !! inside dplyr verbs (see example).","code":""},{"path":"/reference/asDate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"as.Date dbplyr translation wrapper — asDate","text":"","code":"asDate(x)  as_date(x)"},{"path":"/reference/asDate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"as.Date dbplyr translation wrapper — asDate","text":"x R expression","code":""},{"path":"/reference/asDate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"as.Date dbplyr translation wrapper — asDate","text":"","code":"if (FALSE) { con <- DBI::dbConnect(odbc::odbc(), \"Oracle\") date_tbl <- dplyr::copy_to(con,                            data.frame(y = 2000L, m = 10L, d = 10L),                            name = \"tmp\",                            temporary = TRUE)  df <- date_tbl %>%   dplyr::mutate(date_from_parts = !!asDate(paste0(     .data$y, \"/\",     .data$m, \"/\",     .data$d   ))) %>%   collect() }"},{"path":"/reference/assert_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert that tables exist in a cdm object — assert_tables","title":"Assert that tables exist in a cdm object — assert_tables","text":"cdm object list references subset tables OMOP Common Data Model. write function accepts cdm object parameter assert_tables/assertTables help check tables need cdm object, correct columns/fields, (optionally) empty.","code":""},{"path":"/reference/assert_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assert that tables exist in a cdm object — assert_tables","text":"","code":"assert_tables(cdm, tables, empty.ok = FALSE, add = NULL)  assertTables(cdm, tables, empty.ok = FALSE, add = NULL)"},{"path":"/reference/assert_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert that tables exist in a cdm object — assert_tables","text":"cdm cdm object tables character vector table names check. empty.ok empty table (0 rows) considered error? TRUE FALSE (default) add optional AssertCollection created checkmate::makeAssertCollection() errors added .","code":""},{"path":"/reference/assert_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert that tables exist in a cdm object — assert_tables","text":"Invisibly returns cdm object","code":""},{"path":"/reference/assert_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assert that tables exist in a cdm object — assert_tables","text":"","code":"if (FALSE) { # Use assertTables inside a function to check that tables exist countDrugsByGender <- function(cdm) {   assertTables(cdm, tables = c(\"person\", \"drug_era\"), empty.ok = FALSE)    cdm$person %>%     dplyr::inner_join(cdm$drug_era, by = \"person_id\") %>%     dplyr::count(.data$gender_concept_id, .data$drug_concept_id) %>%     dplyr::collect() }  library(CDMConnector) con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con)  countDrugsByGender(cdm)  DBI::dbDisconnect(con, shutdown = TRUE)  }"},{"path":"/reference/assert_write_schema.html","id":null,"dir":"Reference","previous_headings":"","what":"Assert that cdm has a writable schema — assert_write_schema","title":"Assert that cdm has a writable schema — assert_write_schema","text":"cdm object can optionally contain single schema database write access. assert_write_schema checks cdm contains \"write_schema\" attribute tests local dataframes can written tables schema.","code":""},{"path":"/reference/assert_write_schema.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assert that cdm has a writable schema — assert_write_schema","text":"","code":"assert_write_schema(cdm, add = NULL)  assertWriteSchema(cdm, add = NULL)"},{"path":"/reference/assert_write_schema.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assert that cdm has a writable schema — assert_write_schema","text":"cdm cdm object add optional AssertCollection created checkmate::makeAssertCollection() errors added .","code":""},{"path":"/reference/assert_write_schema.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assert that cdm has a writable schema — assert_write_schema","text":"Invisibly returns cdm object","code":""},{"path":"/reference/cdmFlatten.html","id":null,"dir":"Reference","previous_headings":"","what":"Flatten a cdm into a single observation table — cdmFlatten","title":"Flatten a cdm into a single observation table — cdmFlatten","text":"experimental function transforms OMOP CDM single observation table. recommended use filtered CDM cdm small size.","code":""},{"path":"/reference/cdmFlatten.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flatten a cdm into a single observation table — cdmFlatten","text":"","code":"cdmFlatten(   cdm,   domain = c(\"condition\", \"drug\", \"procedure\"),   includeConceptName = TRUE )  cdm_flatten(   cdm,   domain = c(\"condition\", \"drug\", \"procedure\"),   include_concept_name = TRUE )"},{"path":"/reference/cdmFlatten.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flatten a cdm into a single observation table — cdmFlatten","text":"cdm cdm_reference object domain Domains include. Must subset \"condition\", \"drug\", \"procedure\", \"measurement\", \"visit\", \"death\", \"observation\". include_concept_name, includeConceptName concept_name type_concept_name include output table? TRUE (default) FALSE","code":""},{"path":"/reference/cdmFlatten.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flatten a cdm into a single observation table — cdmFlatten","text":"lazy query evaluated result single cdm table","code":""},{"path":[]},{"path":"/reference/cdmFlatten.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Flatten a cdm into a single observation table — cdmFlatten","text":"","code":"if (FALSE) { library(CDMConnector) library(dplyr, warn.conflicts = FALSE)  con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir())  cdm <- cdm_from_con(con, cdm_schema = \"main\")  all_observations <- cdmSubset(cdm, personId = c(2, 18, 42)) %>%   cdmFlatten() %>%   collect()  all_observations #> # A tibble: 213 × 8 #>    person_id observation_.  start_date end_date   type_.  domain obser.  type_. #>        <dbl>          <dbl> <date>     <date>       <dbl> <chr>  <chr>   <chr> #>  1         2       40213201 1986-09-09 1986-09-09  5.81e5 drug   pneumo  <NA> #>  2        18        4116491 1997-11-09 1998-01-09  3.20e4 condi  Escher  <NA> #>  3        18       40213227 2017-01-04 2017-01-04  5.81e5 drug   tetanu  <NA> #>  4        42        4156265 1974-06-13 1974-06-27  3.20e4 condi  Facial  <NA> #>  5        18       40213160 1966-02-23 1966-02-23  5.81e5 drug   poliov  <NA> #>  6        42        4198190 1933-10-29 1933-10-29  3.80e7 proce  Append  <NA> #>  7         2        4109685 1952-07-13 1952-07-27  3.20e4 condi  Lacera  <NA> #>  8        18       40213260 2017-01-04 2017-01-04  5.81e5 drug   zoster  <NA> #>  9        42        4151422 1985-02-03 1985-02-03  3.80e7 proce  Sputum  <NA> #> 10         2        4163872 1993-03-29 1993-03-29  3.80e7 proce  Plain   <NA> #> # ... with 203 more rows, and abbreviated variable names observation_concept_id, #> #   type_concept_id, observation_concept_name, type_concept_name  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/cdmFromCon.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a CDM reference object from a database connection — cdmFromCon","title":"Create a CDM reference object from a database connection — cdmFromCon","text":"Create CDM reference object database connection","code":""},{"path":"/reference/cdmFromCon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a CDM reference object from a database connection — cdmFromCon","text":"","code":"cdmFromCon(   con,   cdmSchema = NULL,   cdmTables = tbl_group(\"default\"),   writeSchema = NULL,   cohortTables = NULL )"},{"path":"/reference/cdmFromCon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a CDM reference object from a database connection — cdmFromCon","text":"con DBI database connection database OMOP CDM v5.4 instance located. cdmSchema schema OMOP CDM tables located. Defaults NULL. cdmTables tables included? Supports character vector, tidyselect selection helpers, table groups. tbl_group(\"\")CDM tables tbl_group(\"vocab\")CDM vocabulary tables tbl_group(\"clinical\")clinical CDM tables writeSchema optional schema CDM database user write access . cohortTables character vector listing cohort table names included CDM object. Cohort tables must write_schema.","code":""},{"path":"/reference/cdmFromCon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a CDM reference object from a database connection — cdmFromCon","text":"list dplyr database table references pointing CDM tables","code":""},{"path":"/reference/cdmFromFiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdmFromFiles","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdmFromFiles","text":"Create CDM reference folder containing parquet, csv, feather files","code":""},{"path":"/reference/cdmFromFiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdmFromFiles","text":"","code":"cdmFromFiles(   path,   cdmTables = deprecated(),   format = \"auto\",   asDataFrame = TRUE )"},{"path":"/reference/cdmFromFiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdmFromFiles","text":"path folder OMOP CDM v5.4 instance located. cdmTables deprecated format file format read ? Must \"auto\" (default), \"parquet\", \"csv\", \"feather\". asDataFrame TRUE (default) read files R dataframes. FALSE read files R Arrow Datasets.","code":""},{"path":"/reference/cdmFromFiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdmFromFiles","text":"list dplyr database table references pointing CDM tables","code":""},{"path":"/reference/cdmName.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the CDM name — cdmName","title":"Get the CDM name — cdmName","text":"Extract CDM name attribute cdm_reference object","code":""},{"path":"/reference/cdmName.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the CDM name — cdmName","text":"","code":"cdmName(cdm)  cdm_name(cdm)"},{"path":"/reference/cdmName.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the CDM name — cdmName","text":"cdm cdm object","code":""},{"path":"/reference/cdmName.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the CDM name — cdmName","text":"name CDM character string","code":""},{"path":"/reference/cdmName.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the CDM name — cdmName","text":"","code":"if (FALSE) { library(CDMConnector) con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir()) cdm <- cdm_from_con(con, \"main\") cdmName(cdm) #> [1] \"Synthea synthetic health database\"  cdm <- cdm_from_con(con, \"main\", cdm_name = \"Example CDM\") cdmName(cdm) #> [1] \"Example CDM\"  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/cdmSample.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a cdm object to a random sample of individuals — cdmSample","title":"Subset a cdm object to a random sample of individuals — cdmSample","text":"cdmSample takes cdm object returns new cdm includes random sample persons cdm. person_ids person table observation_period table considered.","code":""},{"path":"/reference/cdmSample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a cdm object to a random sample of individuals — cdmSample","text":"","code":"cdmSample(cdm, n = 1000)  cdm_sample(cdm, n = 1000)"},{"path":"/reference/cdmSample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a cdm object to a random sample of individuals — cdmSample","text":"cdm cdm_reference object n Number persons include cdm","code":""},{"path":"/reference/cdmSample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a cdm object to a random sample of individuals — cdmSample","text":"modified cdm_reference object clinical tables lazy queries pointing subset","code":""},{"path":[]},{"path":"/reference/cdmSample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a cdm object to a random sample of individuals — cdmSample","text":"","code":"if (FALSE) { library(CDMConnector) library(dplyr, warn.conflicts = FALSE)  con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir())  cdm <- cdm_from_con(con, cdm_schema = \"main\")  cdmSampled <- cdmSample(cdm, n = 2)  cdmSampled$person %>%   select(person_id) #> # Source:   SQL [2 x 1] #> # Database: DuckDB 0.6.1 #>   person_id #>       <dbl> #> 1       155 #> 2      3422  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/cdmSubset.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a cdm object to a set of persons — cdmSubset","title":"Subset a cdm object to a set of persons — cdmSubset","text":"cdmSubset takes cdm object list person IDs input. returns new cdm includes data persons matching provided person IDs. Generated cohorts cdm also subset IDs provided.","code":""},{"path":"/reference/cdmSubset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a cdm object to a set of persons — cdmSubset","text":"","code":"cdmSubset(cdm, personId)  cdm_subset(cdm, person_id)"},{"path":"/reference/cdmSubset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a cdm object to a set of persons — cdmSubset","text":"cdm cdm_reference object person_id, personId numeric vector person IDs include cdm","code":""},{"path":"/reference/cdmSubset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a cdm object to a set of persons — cdmSubset","text":"modified cdm_reference object clinical tables lazy queries pointing subset","code":""},{"path":[]},{"path":"/reference/cdmSubset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a cdm object to a set of persons — cdmSubset","text":"","code":"if (FALSE) { library(CDMConnector) library(dplyr, warn.conflicts = FALSE)  con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir())  cdm <- cdm_from_con(con, cdm_schema = \"main\")  cdm2 <- cdmSubset(cdm, personId = c(2, 18, 42))  cdm2$person %>%   select(1:3) #> # Source:   SQL [3 x 3] #> # Database: DuckDB 0.6.1 #>   person_id gender_concept_id year_of_birth #>       <dbl>             <dbl>         <dbl> #> 1         2              8532          1920 #> 2        18              8532          1965 #> 3        42              8532          1909  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/cdmSubsetCohort.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","title":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","text":"cdmSubset return new cdm object contains lazy queries pointing cdm tables subset individuals generated cohort. Since cdm tables lazy queries, subset operation done tables used. computeQuery can used run SQL used subset cdm table store new table database.","code":""},{"path":"/reference/cdmSubsetCohort.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","text":"","code":"cdmSubsetCohort(cdm, cohortTable = \"cohort\", cohortId = NULL, verbose = FALSE)  cdm_subset_cohort(   cdm,   cohort_table = \"cohort\",   cohort_id = NULL,   verbose = FALSE )"},{"path":"/reference/cdmSubsetCohort.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","text":"cdm cdm_reference object cohortTable, cohort_table name cohort table cdm reference cohortId, cohort_id IDs cohorts want subset cohort table. NULL (default) cohorts cohort table considered. verbose subset messages printed? TRUE FALSE (default)","code":""},{"path":"/reference/cdmSubsetCohort.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","text":"modified cdm_reference clinical tables subset just persons selected cohorts.","code":""},{"path":[]},{"path":"/reference/cdmSubsetCohort.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a cdm to the individuals in one or more cohorts — cdmSubsetCohort","text":"","code":"if (FALSE) { library(CDMConnector) library(dplyr, warn.conflicts = FALSE)  con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir())  cdm <- cdm_from_con(con, cdm_schema = \"main\", write_schema = \"main\")  # generate a cohort path <- system.file(\"cohorts2\", mustWork = TRUE, package = \"CDMConnector\")  cohortSet <- readCohortSet(path) %>%   filter(cohort_name == \"GIBleed_male\")  # subset cdm to persons in the generated cohort cdm <- generateCohortSet(cdm, cohortSet = cohortSet, name = \"gibleed\")  cdmGiBleed <- cdmSubsetCohort(cdm, cohortTable = \"gibleed\")  cdmGiBleed$person %>%   tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 #>       n #>   <dbl> #> 1   237  cdm$person %>%   tally() #> # Source:   SQL [1 x 1] #> # Database: DuckDB 0.6.1 #>       n #>   <dbl> #> 1  2694   DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/cdm_from_con.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a CDM reference object from a database connection — cdm_from_con","title":"Create a CDM reference object from a database connection — cdm_from_con","text":"Create CDM reference object database connection","code":""},{"path":"/reference/cdm_from_con.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a CDM reference object from a database connection — cdm_from_con","text":"","code":"cdm_from_con(   con,   cdm_schema = NULL,   cdm_tables = tbl_group(\"default\"),   write_schema = NULL,   cohort_tables = NULL,   cdm_version = \"5.3\",   cdm_name = NULL )  cdmFromCon(   con,   cdmSchema = NULL,   cdmTables = tbl_group(\"default\"),   writeSchema = NULL,   cohortTables = NULL,   cdmVersion = \"5.3\",   cdmName = NULL )"},{"path":"/reference/cdm_from_con.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a CDM reference object from a database connection — cdm_from_con","text":"con DBI database connection database OMOP CDM v5.4 v5.3 instance located. cdm_schema, cdmSchema schema OMOP CDM tables located. Defaults NULL. cdm_tables, cdmTables tables included? Supports character vector, tidyselect selection helpers, table groups. tbl_group(\"\")CDM tables tbl_group(\"vocab\")CDM vocabulary tables tbl_group(\"clinical\")clinical CDM tables write_schema, writeSchema optional schema CDM database user write access . cohort_tables, cohortTables character vector listing cohort table names included CDM object. cdm_version, cdmVersion version OMOP CDM: \"5.3\" (default), \"5.4\", \"auto\". \"auto\" attempts automatically determine cdm version using heuristics. Cohort tables must write_schema. cdm_name, cdmName name CDM. NULL (default) cdm_source_name .  field CDM_SOURCE table used.","code":""},{"path":"/reference/cdm_from_con.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a CDM reference object from a database connection — cdm_from_con","text":"list dplyr database table references pointing CDM tables","code":""},{"path":"/reference/cdm_from_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdm_from_files","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdm_from_files","text":"Create CDM reference folder containing parquet, csv, feather files","code":""},{"path":"/reference/cdm_from_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdm_from_files","text":"","code":"cdm_from_files(path, format = \"auto\", as_data_frame = TRUE)  cdmFromFiles(path, format = \"auto\", asDataFrame = TRUE)"},{"path":"/reference/cdm_from_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdm_from_files","text":"path folder OMOP CDM v5.4 instance located. format file format read ? Must \"auto\" (default), \"parquet\", \"csv\", \"feather\". as_data_frame, asDataFrame TRUE (default) read files R dataframes. FALSE read files R Arrow Datasets.","code":""},{"path":"/reference/cdm_from_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a CDM reference from a folder containing parquet, csv, or feather\nfiles — cdm_from_files","text":"list dplyr database table references pointing CDM tables","code":""},{"path":"/reference/cohortAttrition.html","id":null,"dir":"Reference","previous_headings":"","what":"Get attrition table from a GeneratedCohortSet object — cohortAttrition","title":"Get attrition table from a GeneratedCohortSet object — cohortAttrition","text":"Get attrition table GeneratedCohortSet object","code":""},{"path":"/reference/cohortAttrition.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get attrition table from a GeneratedCohortSet object — cohortAttrition","text":"","code":"cohortAttrition(x)  cohort_attrition(x)"},{"path":"/reference/cohortAttrition.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get attrition table from a GeneratedCohortSet object — cohortAttrition","text":"x generatedCohortSet object","code":""},{"path":"/reference/cohortCount.html","id":null,"dir":"Reference","previous_headings":"","what":"Get cohort counts from a GeneratedCohortSet object — cohortCount","title":"Get cohort counts from a GeneratedCohortSet object — cohortCount","text":"Get cohort counts GeneratedCohortSet object","code":""},{"path":"/reference/cohortCount.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get cohort counts from a GeneratedCohortSet object — cohortCount","text":"","code":"cohortCount(x)  cohort_count(x)"},{"path":"/reference/cohortCount.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get cohort counts from a GeneratedCohortSet object — cohortCount","text":"x generatedCohortSet object","code":""},{"path":"/reference/cohortSet.html","id":null,"dir":"Reference","previous_headings":"","what":"Get cohort settings from a GeneratedCohortSet object — cohortSet","title":"Get cohort settings from a GeneratedCohortSet object — cohortSet","text":"Get cohort settings GeneratedCohortSet object","code":""},{"path":"/reference/cohortSet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get cohort settings from a GeneratedCohortSet object — cohortSet","text":"","code":"cohortSet(x)  cohort_set(x)"},{"path":"/reference/cohortSet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get cohort settings from a GeneratedCohortSet object — cohortSet","text":"x generatedCohortSet object","code":""},{"path":"/reference/collect.cdm_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"Bring a remote CDM reference into R — collect.cdm_reference","title":"Bring a remote CDM reference into R — collect.cdm_reference","text":"function calls collect list lazy queries returns result list dataframes.","code":""},{"path":"/reference/collect.cdm_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bring a remote CDM reference into R — collect.cdm_reference","text":"","code":"# S3 method for cdm_reference collect(x, ...)"},{"path":"/reference/collect.cdm_reference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bring a remote CDM reference into R — collect.cdm_reference","text":"x cdm_reference object. ... used. Included compatibility.","code":""},{"path":"/reference/collect.cdm_reference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bring a remote CDM reference into R — collect.cdm_reference","text":"cdm_reference object list R dataframes.","code":""},{"path":"/reference/collect.cdm_reference.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bring a remote CDM reference into R — collect.cdm_reference","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) vocab <- cdm_from_con(con, cdm_tables = c(\"concept\", \"concept_ancestor\")) local_vocab <- collect(vocab) DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/computePermanent.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a dplyr query and store the result in a permanent table — computePermanent","title":"Run a dplyr query and store the result in a permanent table — computePermanent","text":"function superceded computeQuery used instead computePermanent.","code":""},{"path":"/reference/computePermanent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a dplyr query and store the result in a permanent table — computePermanent","text":"","code":"computePermanent(x, name, schema = NULL, overwrite = FALSE)  compute_permanent(x, name, schema = NULL, overwrite = FALSE)"},{"path":"/reference/computePermanent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a dplyr query and store the result in a permanent table — computePermanent","text":"x dplyr query name Name table created schema Schema create new table Can length 1 2 vector. (e.g. schema = \"my_schema\", schema = c(\"my_schema\", \"dbo\")) overwrite table already exists remote database overwritten? (TRUE FALSE)","code":""},{"path":"/reference/computePermanent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a dplyr query and store the result in a permanent table — computePermanent","text":"dplyr reference newly created table","code":""},{"path":[]},{"path":"/reference/computeQuery.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute dplyr query and save result in remote database — computeQuery","title":"Execute dplyr query and save result in remote database — computeQuery","text":"function wrapper around dplyr::compute tested several database systems. needed handle edge cases dplyr::compute produce correct SQL.","code":""},{"path":"/reference/computeQuery.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute dplyr query and save result in remote database — computeQuery","text":"","code":"computeQuery(   x,   name = uniqueTableName(),   temporary = TRUE,   schema = NULL,   overwrite = FALSE,   ... )  compute_query(   x,   name = uniqueTableName(),   temporary = TRUE,   schema = NULL,   overwrite = FALSE,   ... )"},{"path":"/reference/computeQuery.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute dplyr query and save result in remote database — computeQuery","text":"x dplyr query name name table create. temporary table temporary: TRUE (default) FALSE schema schema table created. Ignored temporary = TRUE. overwrite table overwritten already exists: TRUE FALSE (default) Ignored temporary = TRUE. ... arguments passed dplyr::compute","code":""},{"path":"/reference/computeQuery.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute dplyr query and save result in remote database — computeQuery","text":"dplyr::tbl() reference newly created table.","code":""},{"path":"/reference/computeQuery.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute dplyr query and save result in remote database — computeQuery","text":"","code":"if (FALSE) { library(CDMConnector)  con <- DBI::dbConnect(duckdb::duckdb(), dbdir = CDMConnector::eunomia_dir()) cdm <- cdm_from_con(con, \"main\")  # create a temporary table in the remote database from a dplyr query drugCount <- cdm$concept %>%   dplyr::count(domain_id == \"Drug\") %>%   computeQuery()  # create a permanent table in the remote database from a dplyr query drugCount <- cdm$concept %>%   dplyr::count(domain_id == \"Drug\") %>%   computeQuery(\"tmp_table\", temporary = FALSE, schema = \"main\")  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/dateadd.html","id":null,"dir":"Reference","previous_headings":"","what":"Add days or years to a date in a dplyr query — dateadd","title":"Add days or years to a date in a dplyr query — dateadd","text":"function must \"unquoted\" using \"bang bang\" operator (!!). See example.","code":""},{"path":"/reference/dateadd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add days or years to a date in a dplyr query — dateadd","text":"","code":"dateadd(date, number, interval = \"day\")"},{"path":"/reference/dateadd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add days or years to a date in a dplyr query — dateadd","text":"date name date column database table character string number number units add. Can positive negative whole number. interval units add. Must either \"day\" (default) \"year\"","code":""},{"path":"/reference/dateadd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add days or years to a date in a dplyr query — dateadd","text":"Platform specific SQL can used dplyr query.","code":""},{"path":"/reference/dateadd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add days or years to a date in a dplyr query — dateadd","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb()) date_tbl <- dplyr::copy_to(con, data.frame(date1 = as.Date(\"1999-01-01\")),                            name = \"tmpdate\", overwrite = TRUE, temporary = TRUE)  df <- date_tbl %>%   dplyr::mutate(date2 = !!dateadd(\"date1\", 1, interval = \"year\")) %>%   dplyr::collect()  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/datediff.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the difference between two days — datediff","title":"Compute the difference between two days — datediff","text":"function must \"unquoted\" using \"bang bang\" operator (!!). See example.","code":""},{"path":"/reference/datediff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the difference between two days — datediff","text":"","code":"datediff(start, end, interval = \"day\")"},{"path":"/reference/datediff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the difference between two days — datediff","text":"start name start date column database string. end name end date column database string. interval units use difference calculation. Must either \"day\" (default) \"year\".","code":""},{"path":"/reference/datediff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the difference between two days — datediff","text":"Platform specific SQL can used dplyr query.","code":""},{"path":"/reference/datediff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the difference between two days — datediff","text":"","code":"if (FALSE) { library(SqlUtilities) con <- DBI::dbConnect(duckdb::duckdb()) date_tbl <- dplyr::copy_to(con, data.frame(date1 = as.Date(\"1999-01-01\")),                            name = \"tmpdate\", overwrite = TRUE, temporary = TRUE)  df <- date_tbl %>%   dplyr::mutate(date2 = !!dateadd(\"date1\", 1, interval = \"year\")) %>%   dplyr::mutate(dif_years = !!datediff(\"date1\", \"date2\", interval = \"year\")) %>%   dplyr::collect()  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/dbConnect-dbConnectDetails-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","title":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","text":"Create connection details, save object, use connect database using dbConnect later program execution.","code":""},{"path":"/reference/dbConnect-dbConnectDetails-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","text":"","code":"# S4 method for dbConnectDetails dbConnect(drv)"},{"path":"/reference/dbConnect-dbConnectDetails-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","text":"drv dbConnectDetails object created dbConnectDetails()","code":""},{"path":"/reference/dbConnect-dbConnectDetails-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","text":"S4 object inherits DBIConnection used communicate database engine.","code":""},{"path":"/reference/dbConnect-dbConnectDetails-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Connect to a database using stored connection details — dbConnect,dbConnectDetails-method","text":"","code":"if (FALSE) { library(DBI) connectionDetails <- dbConnectDetails(RPostgres::Postgres(),                                       dbname = \"cdm\",                                       host = \"localhost\",                                       user = \"postgres\",                                       password = Sys.getenv(\"password\"))   selfContainedQuery <- function(dbConnectDetails) {    con <- dbConnect(connectionDetails)    on.exit(dbDisonnect(con))    dbGetQuery(con, \"select count(*) as n from synthea1k.person\")  }  selfContainedQuery(connectionDetails) }"},{"path":"/reference/dbConnectDetails-class.html","id":null,"dir":"Reference","previous_headings":"","what":"dbConnect arguments stored for later use — dbConnectDetails-class","title":"dbConnect arguments stored for later use — dbConnectDetails-class","text":"dbConnect arguments stored later use","code":""},{"path":"/reference/dbConnectDetails.html","id":null,"dir":"Reference","previous_headings":"","what":"Save database connection information in an object — dbConnectDetails","title":"Save database connection information in an object — dbConnectDetails","text":"dbConnectDetails returns object can used connect database dbConnect future point execution. Functions need create new connection database dbConnect can accept dbConnectDetails object argument use create new connection.","code":""},{"path":"/reference/dbConnectDetails.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save database connection information in an object — dbConnectDetails","text":"","code":"dbConnectDetails(drv, ...)"},{"path":"/reference/dbConnectDetails.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save database connection information in an object — dbConnectDetails","text":"drv DBI driver (e.g. RPostgres::Postgres()) ... DBI Driver parameters needed create connection using DBI::dbConnect()","code":""},{"path":"/reference/dbConnectDetails.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save database connection information in an object — dbConnectDetails","text":"dbConnectArgs object can passed dbConnect","code":""},{"path":"/reference/dbConnectDetails.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save database connection information in an object — dbConnectDetails","text":"","code":"if (FALSE) { library(DBI) connectionDetails <- dbConnectDetails(RPostgres::Postgres(),                                       dbname = \"cdm\",                                       host = \"localhost\",                                       user = \"postgres\",                                       password = Sys.getenv(\"password\"))   selfContainedQuery <- function(dbConnectDetails) {    con <- dbConnect(connectionDetails)    on.exit(dbDisonnect(con))    dbGetQuery(con, \"select count(*) as n from synthea1k.person\")  }  selfContainedQuery(connectionDetails) }"},{"path":"/reference/dbms.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","title":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","text":"Get database management system (dbms) cdm_reference DBI connection","code":""},{"path":"/reference/dbms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","text":"","code":"dbms(con)"},{"path":"/reference/dbms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","text":"con DBI connection cdm_reference","code":""},{"path":"/reference/dbms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","text":"character string representing dbms can used SqlRender","code":""},{"path":"/reference/dbms.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the database management system (dbms) from a cdm_reference or DBI\nconnection — dbms","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) cdm <- cdm_from_con(con) dbms(cdm) dbms(con) }"},{"path":"/reference/downloadEunomiaData.html","id":null,"dir":"Reference","previous_headings":"","what":"Download Eunomia data files — downloadEunomiaData","title":"Download Eunomia data files — downloadEunomiaData","text":"Download Eunomia data files https://github.com/darwin-eu/EunomiaDatasets","code":""},{"path":"/reference/downloadEunomiaData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download Eunomia data files — downloadEunomiaData","text":"","code":"downloadEunomiaData(   datasetName = \"GiBleed\",   cdmVersion = \"5.3\",   pathToData = Sys.getenv(\"EUNOMIA_DATA_FOLDER\"),   overwrite = FALSE )  download_eunomia_data(   dataset_name = \"GiBleed\",   cdm_version = \"5.3\",   path_to_data = Sys.getenv(\"EUNOMIA_DATA_FOLDER\"),   overwrite = FALSE )"},{"path":"/reference/downloadEunomiaData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download Eunomia data files — downloadEunomiaData","text":"overwrite Control whether existing archive file overwritten already exist. dataset_name, datasetName data set name found https://github.com/darwin-eu/EunomiaDatasets. data set name corresponds folder data set ZIP files cdm_version, cdmVersion OMOP CDM version. version appear suffix data file, example: datasetName_cdmVersion.zip. Default: '5.3' path_to_data, pathToData path Eunomia data stored file system., default value environment variable \"EUNOMIA_DATA_FOLDER\" used.","code":""},{"path":"/reference/downloadEunomiaData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download Eunomia data files — downloadEunomiaData","text":"Invisibly returns destination download successful.","code":""},{"path":"/reference/downloadEunomiaData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download Eunomia data files — downloadEunomiaData","text":"","code":"if (FALSE) { downloadEunomiaData(\"GiBleed\") }"},{"path":"/reference/download_optional_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Download the example Eunomia CDM dataset — download_optional_data","title":"Download the example Eunomia CDM dataset — download_optional_data","text":"function deprecated. Use downloadEunomiaData instead.","code":""},{"path":"/reference/download_optional_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download the example Eunomia CDM dataset — download_optional_data","text":"","code":"download_optional_data()"},{"path":"/reference/dropStemTables.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop tables starting with a prefix/stem — dropStemTables","title":"Drop tables starting with a prefix/stem — dropStemTables","text":"Drop tables starting prefix/stem","code":""},{"path":"/reference/dropStemTables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop tables starting with a prefix/stem — dropStemTables","text":"","code":"dropStemTables(cdm, stem, verbose = FALSE)"},{"path":"/reference/dropStemTables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop tables starting with a prefix/stem — dropStemTables","text":"cdm CDM reference object stem prefix/stem identifying tables drop. example, stem \"study_results\" lead dropping table starting (ie \"study_results\" \"study_results_analysis_1\" dropped exist write schema). Prefix interpreted regular expression. verbose Print message dropping table? TRUE FALSE (default)","code":""},{"path":"/reference/dropStemTables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Drop tables starting with a prefix/stem — dropStemTables","text":"Invisibly returns cdm object","code":""},{"path":"/reference/dropTable.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop tables from write_schema of a cdm object — dropTable","title":"Drop tables from write_schema of a cdm object — dropTable","text":"cdm objects can zero cohort tables stored special schema user write access. function removes tables cdm's write_schema","code":""},{"path":"/reference/dropTable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop tables from write_schema of a cdm object — dropTable","text":"","code":"dropTable(cdm, name, verbose = FALSE)  drop_table(cdm, name, verbose = FALSE)"},{"path":"/reference/dropTable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop tables from write_schema of a cdm object — dropTable","text":"cdm cdm reference name character vector tables cdm's write_schema tidyselect specification tables drop. (e.g. starts_with(\"temp\"), matches(\"study01\"), etc.) verbose Print message dropping table? TRUE FALSE (default)","code":""},{"path":"/reference/dropTable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Drop tables from write_schema of a cdm object — dropTable","text":"Returns cdm object selected tables removed","code":""},{"path":"/reference/dropTable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drop tables from write_schema of a cdm object — dropTable","text":"","code":"if (FALSE) { library(CDMConnector)  con <- DBI::dbConnect(duckdb::duckdb(), dbdir = CDMConnector::eunomia_dir()) cdm <- cdm_from_con(con, cdm_schema = \"main\", write_schema = \"main\")  # create two temporary tables in the remote database from a query with a common prefix cdm$tmp_table <- cdm$concept %>%   dplyr::count(domain_id == \"Drug\") %>%   computeQuery(\"tmp_table\", temporary = FALSE, schema = \"main\")  cdm$tmp_table2 <- cdm$concept %>%   dplyr::count(domain_id == \"Condition\") %>%   computeQuery(\"tmp_table2\", temporary = FALSE, schema = \"main\")  stringr::str_subset(DBI::dbListTables(con), \"tmp\") #> [1] \"tmp_table\"  \"tmp_table2\" stringr::str_subset(names(cdm), \"tmp\") #> [1] \"tmp_table\"  \"tmp_table2\"  # drop tables with a common prefix cdm <- dropTable(cdm, name = dplyr::starts_with(\"tmp\"))  stringr::str_subset(DBI::dbListTables(con), \"tmp\") #> character(0) stringr::str_subset(names(cdm), \"tmp\") #> character(0)  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/eunomiaDir.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a copy of a Eunomia dataset — eunomiaDir","title":"Create a copy of a Eunomia dataset — eunomiaDir","text":"Creates copy Eunomia database, returns path new database file. dataset yet exist user's computer attempt download source data path defined EUNOMIA_DATA_FOLDER environment variable.","code":""},{"path":"/reference/eunomiaDir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a copy of a Eunomia dataset — eunomiaDir","text":"","code":"eunomiaDir(   datasetName = \"GiBleed\",   cdmVersion = \"5.3\",   pathToData = Sys.getenv(\"EUNOMIA_DATA_FOLDER\"),   dbms = \"duckdb\",   databaseFile = tempfile(fileext = paste0(\".\", dbms)) )"},{"path":"/reference/eunomiaDir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a copy of a Eunomia dataset — eunomiaDir","text":"datasetName data set name found https://github.com/darwin-eu/EunomiaDatasets. data set name corresponds folder data set ZIP files cdmVersion OMOP CDM version. version appear suffix data file, example: datasetName_cdmVersion.zip. Default: '5.3' pathToData path Eunomia data stored file system., default value environment variable \"EUNOMIA_DATA_FOLDER\" used. dbms database system use. \"sqlite\" \"duckdb\" (default) databaseFile path database file copied . default, database copied temporary folder, deleted end R session.","code":""},{"path":"/reference/eunomiaDir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a copy of a Eunomia dataset — eunomiaDir","text":"file path new Eunomia dataset copy","code":""},{"path":"/reference/eunomiaDir.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a copy of a Eunomia dataset — eunomiaDir","text":"","code":"if (FALSE) {  conn <- DBI::dbConnect(RSQLite::SQLite(), eunomiaDir(\"GiBleed\"))  DBI::dbDisconnect(conn)   conn <- DBI::dbConnect(duckdb::duckdb(), eunomiaDir(\"GiBleed\", dbms = \"duckdb\"))  DBI::dbDisconnect(conn, shutdown = TRUE)   conn <- DatabaseConnector::connect(dbms = \"sqlite\", server = eunomiaDir(\"GiBleed\"))  DatabaseConnector::disconnect(conn) }"},{"path":"/reference/eunomia_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new Eunomia CDM — eunomia_dir","title":"Create a new Eunomia CDM — eunomia_dir","text":"Create copy duckdb Eunomia CDM return file path","code":""},{"path":"/reference/eunomia_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new Eunomia CDM — eunomia_dir","text":"","code":"eunomia_dir(exdir = NULL)"},{"path":"/reference/eunomia_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new Eunomia CDM — eunomia_dir","text":"exdir Enclosing directory Eunomia CDM created. NULL (default) temp folder created.","code":""},{"path":"/reference/eunomia_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new Eunomia CDM — eunomia_dir","text":"full path new Eunomia CDM can passed dbConnect()","code":""},{"path":"/reference/eunomia_dir.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new Eunomia CDM — eunomia_dir","text":"","code":"if (FALSE) { library(DBI) library(CDMConnector) con <- dbConnect(duckdb::duckdb(), dbdir = getEunomiaPath()) dbListTables(con) dbDisconnect(con) }"},{"path":"/reference/eunomia_is_available.html","id":null,"dir":"Reference","previous_headings":"","what":"Has the Eunomia dataset been cached? — eunomia_is_available","title":"Has the Eunomia dataset been cached? — eunomia_is_available","text":"Eunomia dataset cached?","code":""},{"path":"/reference/eunomia_is_available.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Has the Eunomia dataset been cached? — eunomia_is_available","text":"","code":"eunomia_is_available(dataset_name = \"GiBleed\", cdm_version = \"5.3\")  eunomiaIsAvailable(datasetName = \"GiBleed\", cdmVersion = \"5.3\")"},{"path":"/reference/eunomia_is_available.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Has the Eunomia dataset been cached? — eunomia_is_available","text":"dataset_name, datasetName Name Eunomia dataset check. Defaults \"GiBleed\". cdm_version, cdmVersion Version Eunomia dataset check. Must \"5.3\" \"5.4\".","code":""},{"path":"/reference/eunomia_is_available.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Has the Eunomia dataset been cached? — eunomia_is_available","text":"TRUE eunomia example dataset available FASLE otherwise","code":""},{"path":"/reference/extractLoadData.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract the Eunomia data files and load into a SQLite or duckdb database — extractLoadData","title":"Extract the Eunomia data files and load into a SQLite or duckdb database — extractLoadData","text":"Extract files .ZIP file creates SQLite duckdb OMOP CDM database stored directory .ZIP file.","code":""},{"path":"/reference/extractLoadData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract the Eunomia data files and load into a SQLite or duckdb database — extractLoadData","text":"","code":"extractLoadData(from, to, dbms = \"sqlite\", verbose = FALSE)"},{"path":"/reference/extractLoadData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract the Eunomia data files and load into a SQLite or duckdb database — extractLoadData","text":"path .ZIP file contains csv CDM source files path .sqlite .duckdb file created dbms file based database system use: 'sqlite' (default) 'duckdb' verbose Print progress notes? TRUE FALSE","code":""},{"path":"/reference/generateCohortSet.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a cohort set on a cdm object — generateCohortSet","title":"Generate a cohort set on a cdm object — generateCohortSet","text":"\"GeneratedCohortSet\" object consists several components remote table reference OHDSI cohort table least columns: cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. Additional columns optional analytic packages define additional columns specific certain analytic cohorts. settings attribute points remote table containing cohort settings including names cohorts. attrition attribute points remote table attrition information recorded generation. attribute optional. Since calculating attrition takes additional compute can skipped resulting NULL attrition attribute. cohortCounts attribute points remote table containing cohort counts three attributes tidy tables. implementation object experimental user feedback welcome.  One key design principle GeneratedCohortSet objects created can persist across analysis execution modified creation. possible modify GeneratedCohortSet object invalidate attributes may longer accurate.","code":""},{"path":"/reference/generateCohortSet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a cohort set on a cdm object — generateCohortSet","text":"","code":"generateCohortSet(   cdm,   cohortSet,   name = \"cohort\",   computeAttrition = FALSE,   overwrite = FALSE )  generate_cohort_set(   cdm,   cohort_set,   name = \"cohort\",   compute_attrition = FALSE,   overwrite = FALSE )"},{"path":"/reference/generateCohortSet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a cohort set on a cdm object — generateCohortSet","text":"cdm cdm reference created CDMConnector. write_schema must specified. name Name cohort table created. also used prefix cohort attribute tables. overwrite cohort table overwritten already exists? TRUE FALSE (default) cohort_set, cohortSet cohortSet object created readCohortSet(). compute_attrition, computeAttrition attrition computed? TRUE FALSE (default)","code":""},{"path":"/reference/generateCohortSet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a cohort set on a cdm object — generateCohortSet","text":"","code":"if (FALSE) { library(CDMConnector) con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir()) cdm <- cdm_from_con(con,                     cdm_schema = \"main\",                     cdm_tables = c(tbl_group(\"default\")),                     write_schema = \"main\")  cohortSet <- readCohortSet(system.file(\"cohorts2\", package = \"CDMConnector\")) cdm <- generateCohortSet(cdm, cohortSet, name = \"cohort\")  print(cdm$cohort)  attrition(cdm$cohort) settings(cdm$cohort) cohortCounts(cdm$cohort) }"},{"path":"/reference/listTables.html","id":null,"dir":"Reference","previous_headings":"","what":"List tables in a schema — listTables","title":"List tables in a schema — listTables","text":"DBI::dbListTables can used get tables database always specific schema. listTables list tables schema.","code":""},{"path":"/reference/listTables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List tables in a schema — listTables","text":"","code":"listTables(con, schema = NULL)"},{"path":"/reference/listTables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List tables in a schema — listTables","text":"con DBI connection database schema name schema database. NULL, returns DBI::dbListTables(con).","code":""},{"path":"/reference/listTables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List tables in a schema — listTables","text":"character vector table names","code":""},{"path":"/reference/listTables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List tables in a schema — listTables","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) listTables(con, schema = \"main\") }"},{"path":"/reference/list_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"List tables in a schema — list_tables","title":"List tables in a schema — list_tables","text":"DBI::dbListTables can used get tables database always specific schema. listTables list tables schema.","code":""},{"path":"/reference/list_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List tables in a schema — list_tables","text":"","code":"list_tables(con, schema = NULL)  listTables(con, schema = NULL)"},{"path":"/reference/list_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List tables in a schema — list_tables","text":"con DBI connection database schema name schema database. NULL, returns DBI::dbListTables(con).","code":""},{"path":"/reference/list_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List tables in a schema — list_tables","text":"character vector table names","code":""},{"path":"/reference/list_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List tables in a schema — list_tables","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) listTables(con, schema = \"main\") }"},{"path":"/reference/newGeneratedCohortSet.html","id":null,"dir":"Reference","previous_headings":"","what":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"constructor function used analytic package developers create generatedCohortSet objects. Users never need call function. use function ensures generatedCohortSet valid structure.","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"","code":"newGeneratedCohortSet(   cohort_ref,   cohort_set_ref = NULL,   cohort_attrition_ref = NULL,   cohort_count_ref = NULL )"},{"path":"/reference/newGeneratedCohortSet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"cohort_ref tbl_sql object points remote cohort table following first four columns: cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. Additional columns optional. cohort_set_ref tbl_sql object points remote table following first two columns: cohort_definition_id, cohort_name. Additional columns optional. cohort_definition_id primary key table uniquely identify rows. cohort_attrition_ref tbl_sql object points attrition table remote database first column cohort_definition_id. cohort_count_ref tbl_sql object points cohort_count table remote database columns cohort_definition_id, cohort_entries, cohort_subjects.","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"generatedCohortSet object tbl_sql reference cohort table write_schema OMOP CDM","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"generatedCohort set person-time OMOP CDM database. generatedCohort can represented table three columns: subject_id, cohort_start_date, cohort_end_date. Subject_id person_id OMOP CDM. generatedCohortSet collection one generatedCohorts can represented table four columns: cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. constructor function defines generatedCohortSet object R. object extension tbl_sql object defined dplyr. lazy database query points cohort table database least columns cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. table optionally columns well. addition generatedCohortSet object three optional attributes. : cohort_set, cohort_attrition, cohort_count. attributes also lazy SQL query (tbl_sql) points table database described .","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"cohort-set","dir":"Reference","previous_headings":"","what":"cohort_set","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"cohort_set table one row per cohort_definition_id. first two columns cohort_set table : cohort_definition_id, cohort_name. Additional columns can added. cohort_set table meant store metadata cohort definition.","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"cohort-attrition","dir":"Reference","previous_headings":"","what":"cohort_attrition","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"cohort_attrition optional table stores attrition information recorded cohort generation process many persons dropped step inclusion rule application. first column table cohort_definition_id columns currently constraints.","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"cohort-count","dir":"Reference","previous_headings":"","what":"cohort_count","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"cohort_count option attribute table records number records number unique persons cohort generatedCohortSet. derived metadata can re-derived long cohort_set, complete list cohorts set, available. Column names cohort_count : cohort_definition_id, cohort_entries, cohort_subjects.","code":""},{"path":"/reference/newGeneratedCohortSet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Low level constructor for GeneratedCohortSet objects for package developers — newGeneratedCohortSet","text":"","code":"if (FALSE) {  # This function is for developers who are creating generatedCohortSet  # objects in their packages. The function should accept a cdm_reference  # object as the first argument and return a cdm_reference object with the  # cohort table added. The second argument should be `name` which will be  # the prefix for the database tables, the name of the cohort table in the  # database and the name of the cohort table in the cdm object.  # Other optional arguments can be added after the first two.   generateCustomCohort <- function(cdm, name, ...) {     # accept a cdm_reference object as input    checkmate::assertClass(cdm, \"cdm_reference\")    con <- attr(cdm, \"dbcon\")     # Create the tables in the database however you like    # All the tables should be prefixed with `name`    # The cohort table should be called `name` in the database     # Create the dplyr table references    cohort_ref <- dplyr::tbl(con, name)    cohort_set <- dplyr::tbl(con, paste0(name, \"_set\"))    cohort_attrition_ref <- dplyr::tbl(con, paste0(name, \"_attrition\"))    cohort_count_ref <- dplyr::tbl(con, paste0(name, \"_count\"))     # create the generated cohort set object using the constructor    generatedCohortSet <- newGeneratedCohortSet(       cohort_ref,       cohort_set_ref = cohort_set_ref,       cohort_attrition_ref = cohort_attrition_ref,       cohort_count_ref = cohort_count_ref)  .   # Add the generatedCohortSet to the cdm and return the cdm    cdm[[name]] <- generatedCohortSet    return(cdm)  } }"},{"path":"/reference/new_generated_cohort_set.html","id":null,"dir":"Reference","previous_headings":"","what":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"constructor function used analytic package developers create generatedCohortSet objects. Users never need call function. use function ensures generatedCohortSet valid structure.","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"","code":"new_generated_cohort_set(   cohort_ref,   cohort_set_ref = NULL,   cohort_attrition_ref = NULL,   cohort_count_ref = NULL )  newGeneratedCohortSet(   cohortRef,   cohortSetRef = NULL,   cohortAttritionRef = NULL,   cohortCountRef = NULL )"},{"path":"/reference/new_generated_cohort_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"cohort_ref, cohortRef tbl_sql object points remote cohort table following first four columns: cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. Additional columns optional. cohort_set_ref, cohortSetRef tbl_sql object points remote table following first two columns: cohort_definition_id, cohort_name. Additional columns optional. cohort_definition_id primary key table uniquely identify rows. cohort_attrition_ref, cohortAttritionRef tbl_sql object points attrition table remote database first column cohort_definition_id. cohort_count_ref, cohortCountRef tbl_sql object points cohort_count table remote database columns cohort_definition_id, cohort_entries, cohort_subjects.","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"generatedCohortSet object tbl_sql reference cohort table write_schema OMOP CDM","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"generatedCohort set person-time OMOP CDM database. generatedCohort can represented table three columns: subject_id, cohort_start_date, cohort_end_date. Subject_id person_id OMOP CDM. generatedCohortSet collection one generatedCohorts can represented table four columns: cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. constructor function defines generatedCohortSet object R. object extension tbl_sql object defined dplyr. lazy database query points cohort table database least columns cohort_definition_id, subject_id, cohort_start_date, cohort_end_date. table optionally columns well. addition generatedCohortSet object three optional attributes. : cohort_set, cohort_attrition, cohort_count. attributes also lazy SQL query (tbl_sql) points table database described .","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"cohort-set","dir":"Reference","previous_headings":"","what":"cohort_set","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"cohort_set table one row per cohort_definition_id. first two columns cohort_set table : cohort_definition_id, cohort_name. Additional columns can added. cohort_set table meant store metadata cohort definition.","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"cohort-attrition","dir":"Reference","previous_headings":"","what":"cohort_attrition","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"cohort_attrition optional table stores attrition information recorded cohort generation process many persons dropped step inclusion rule application. first column table cohort_definition_id columns currently constraints.","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"cohort-count","dir":"Reference","previous_headings":"","what":"cohort_count","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"cohort_count option attribute table records number records number unique persons cohort generatedCohortSet. derived metadata can re-derived long cohort_set, complete list cohorts set, available. Column names cohort_count : cohort_definition_id, number_records, number_subjects.","code":""},{"path":"/reference/new_generated_cohort_set.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Low level constructor for GeneratedCohortSet objects for package developers — new_generated_cohort_set","text":"","code":"if (FALSE) {  # This function is for developers who are creating generatedCohortSet  # objects in their packages. The function should accept a cdm_reference  # object as the first argument and return a cdm_reference object with the  # cohort table added. The second argument should be `name` which will be  # the prefix for the database tables, the name of the cohort table in the  # database and the name of the cohort table in the cdm object.  # Other optional arguments can be added after the first two.   generateCustomCohort <- function(cdm, name, ...) {     # accept a cdm_reference object as input    checkmate::assertClass(cdm, \"cdm_reference\")    con <- attr(cdm, \"dbcon\")     # Create the tables in the database however you like    # All the tables should be prefixed with `name`    # The cohort table should be called `name` in the database     # Create the dplyr table references    cohort_ref <- dplyr::tbl(con, name)    cohort_set <- dplyr::tbl(con, paste0(name, \"_set\"))    cohort_attrition_ref <- dplyr::tbl(con, paste0(name, \"_attrition\"))    cohort_count_ref <- dplyr::tbl(con, paste0(name, \"_count\"))     # create the generated cohort set object using the constructor    generatedCohortSet <- new_generated_cohort_set(       cohort_ref,       cohort_set_ref = cohort_set_ref,       cohort_attrition_ref = cohort_attrition_ref,       cohort_count_ref = cohort_count_ref)  .   # Add the generatedCohortSet to the cdm and return the cdm    cdm[[name]] <- generatedCohortSet    return(cdm)  } }"},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"/reference/print.cdm_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a CDM reference object — print.cdm_reference","title":"Print a CDM reference object — print.cdm_reference","text":"Print CDM reference object","code":""},{"path":"/reference/print.cdm_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a CDM reference object — print.cdm_reference","text":"","code":"# S3 method for cdm_reference print(x, ...)"},{"path":"/reference/print.cdm_reference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a CDM reference object — print.cdm_reference","text":"x cdm_reference object ... Included compatibility generic. used.","code":""},{"path":"/reference/print.cdm_reference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a CDM reference object — print.cdm_reference","text":"Invisibly returns input","code":""},{"path":"/reference/readCohortSet.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a set of cohort definitions into R — readCohortSet","title":"Read a set of cohort definitions into R — readCohortSet","text":"\"cohort set\" collection cohort definitions. R stored dataframe cohort_definition_id, cohort_name, cohort columns. disk stored folder CohortsToCreate.csv file one json files. CohortsToCreate.csv file missing json files folder used, cohort_definition_id automatically assigned alphabetical order, cohort_name match file names.","code":""},{"path":"/reference/readCohortSet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a set of cohort definitions into R — readCohortSet","text":"","code":"readCohortSet(path)"},{"path":"/reference/readCohortSet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a set of cohort definitions into R — readCohortSet","text":"path path folder containing Circe cohort definition json files optionally csv file named CohortsToCreate.csv columns cohortId, cohortName, jsonPath.","code":""},{"path":"/reference/read_cohort_set.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a set of cohort definitions into R — read_cohort_set","title":"Read a set of cohort definitions into R — read_cohort_set","text":"\"cohort set\" collection cohort definitions. R stored dataframe cohort_definition_id, cohort_name, cohort columns. disk stored folder CohortsToCreate.csv file one json files. CohortsToCreate.csv file missing json files folder used, cohort_definition_id automatically assigned alphabetical order, cohort_name match file names.","code":""},{"path":"/reference/read_cohort_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a set of cohort definitions into R — read_cohort_set","text":"","code":"read_cohort_set(path)  readCohortSet(path)"},{"path":"/reference/read_cohort_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a set of cohort definitions into R — read_cohort_set","text":"path path folder containing Circe cohort definition json files optionally csv file named CohortsToCreate.csv columns cohortId, cohortName, jsonPath.","code":""},{"path":"/reference/snapshot.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract CDM metadata — snapshot","title":"Extract CDM metadata — snapshot","text":"Extract name, version, selected record counts cdm.","code":""},{"path":"/reference/snapshot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract CDM metadata — snapshot","text":"","code":"snapshot(cdm)"},{"path":"/reference/snapshot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract CDM metadata — snapshot","text":"cdm cdm object","code":""},{"path":"/reference/snapshot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract CDM metadata — snapshot","text":"named list attributes cdm including selected fields cdm_source table record counts person observation_period tables","code":""},{"path":"/reference/snapshot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract CDM metadata — snapshot","text":"","code":"if (FALSE) { library(CDMConnector) con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir()) cdm <- cdm_from_con(con, cdm_tables = c(tbl_group(\"default\"), \"cdm_source\")) snapshot(cdm)  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/stow.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect a list of lazy queries and save the results as files — stow","title":"Collect a list of lazy queries and save the results as files — stow","text":"Collect list lazy queries save results files","code":""},{"path":"/reference/stow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect a list of lazy queries and save the results as files — stow","text":"","code":"stow(cdm, path, format = \"parquet\")"},{"path":"/reference/stow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect a list of lazy queries and save the results as files — stow","text":"cdm cdm object path folder save cdm object format file format use: \"parquet\", \"csv\", \"feather\".","code":""},{"path":"/reference/stow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect a list of lazy queries and save the results as files — stow","text":"Invisibly returns cdm input","code":""},{"path":"/reference/stow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collect a list of lazy queries and save the results as files — stow","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), dbdir = eunomia_dir()) vocab <- cdm_from_con(con, cdm_tables = c(\"concept\", \"concept_ancestor\")) stow(vocab, here::here(\"vocab_tables\")) DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/summarise_quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile calculation using dbplyr — summarise_quantile","title":"Quantile calculation using dbplyr — summarise_quantile","text":"function provides DBMS independent syntax quantiles estimation. Can used combination mutate() calculating aggregate metrics (min, max, mean). summarise_quantile(), summarize_quantile(), summariseQuantile() summarizeQuantile() synonyms.","code":""},{"path":"/reference/summarise_quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile calculation using dbplyr — summarise_quantile","text":"","code":"summarise_quantile(.data, x = NULL, probs, name_suffix = \"value\")  summarize_quantile(.data, x = NULL, probs, name_suffix = \"value\")  summariseQuantile(.data, x = NULL, probs, nameSuffix = \"value\")  summarizeQuantile(.data, x = NULL, probs, nameSuffix = \"value\")"},{"path":"/reference/summarise_quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile calculation using dbplyr — summarise_quantile","text":".data lazy data frame backed database query. x column name whose sample quantiles wanted. probs numeric vector probabilities values [0,1]. name_suffix, nameSuffix character; appended numerical quantile value column name part.","code":""},{"path":"/reference/summarise_quantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile calculation using dbplyr — summarise_quantile","text":"object type '.data'","code":""},{"path":"/reference/summarise_quantile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile calculation using dbplyr — summarise_quantile","text":"Implemented quantiles estimation algorithm returns values analogous quantile{stats} argument type = 1. See discussion Hyndman Fan (1996). Results differ PERCENTILE_CONT natively implemented various DBMS, returned values equal quantile{stats} default argument type = 7","code":""},{"path":"/reference/summarise_quantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile calculation using dbplyr — summarise_quantile","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb()) mtcars_tbl <- dplyr::copy_to(con, mtcars, name = \"tmp\", overwrite = TRUE, temporary = TRUE)  df <- mtcars_tbl %>%  dplyr::group_by(cyl) %>%  dplyr::mutate(mean = mean(mpg, na.rm = TRUE)) %>%  summarise_quantile(mpg, probs = c(0, 0.2, 0.4, 0.6, 0.8, 1),                     name_suffix = \"quant\") %>%  dplyr::collect()  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/reference/tbl_group.html","id":null,"dir":"Reference","previous_headings":"","what":"CDM table selection helper — tbl_group","title":"CDM table selection helper — tbl_group","text":"OMOP CDM tables grouped together tbl_group function allows users easily create CDM reference including one table groups.","code":""},{"path":"/reference/tbl_group.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CDM table selection helper — tbl_group","text":"","code":"tbl_group(group)  tblGroup(group)"},{"path":"/reference/tbl_group.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CDM table selection helper — tbl_group","text":"group character vector CDM table groups: \"vocab\", \"clinical\", \"\", \"default\", \"derived\".","code":""},{"path":"/reference/tbl_group.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CDM table selection helper — tbl_group","text":"character vector CDM tables names groups","code":""},{"path":"/reference/tbl_group.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CDM table selection helper — tbl_group","text":"\"default\" table group meant capture commonly used set CDM tables. Currently \"default\" group : person, observation_period, visit_occurrence, visit_detail, condition_occurrence, drug_exposure, procedure_occurrence, device_exposure, measurement, observation, death, note, note_nlp, specimen, fact_relationship, location, care_site, provider, payer_plan_period, cost, drug_era, dose_era, condition_era, concept, vocabulary, concept_relationship, concept_ancestor, concept_synonym, drug_strength","code":""},{"path":"/reference/tbl_group.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CDM table selection helper — tbl_group","text":"","code":"if (FALSE) { con <- DBI::dbConnect(RPostgres::Postgres(),                       dbname = \"cdm\",                       host = \"localhost\",                       user = \"postgres\",                       password = Sys.getenv(\"PASSWORD\"))  cdm <- cdm_from_con(con, cdm_tables = tbl_group(\"vocab\")) }"},{"path":"/reference/validate_cdm.html","id":null,"dir":"Reference","previous_headings":"","what":"Validation report for a CDM — validate_cdm","title":"Validation report for a CDM — validate_cdm","text":"Print short validation report cdm object. validation includes checking column names correct tables empty. short report printed console. function meant interactive use.","code":""},{"path":"/reference/validate_cdm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validation report for a CDM — validate_cdm","text":"","code":"validate_cdm(cdm)  validateCdm(cdm)"},{"path":"/reference/validate_cdm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validation report for a CDM — validate_cdm","text":"cdm cdm reference object.","code":""},{"path":"/reference/validate_cdm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validation report for a CDM — validate_cdm","text":"Invisibly returns cdm input","code":""},{"path":"/reference/validate_cdm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validation report for a CDM — validate_cdm","text":"","code":"if (FALSE) { con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir()) cdm <- cdm_from_con(con, cdm_tables = c(\"person\", \"observation_period\")) validate_cdm(cdm) DBI::dbDisconnect(con) }"},{"path":"/reference/version.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the CDM version — version","title":"Get the CDM version — version","text":"Extract CDM version attribute cdm_reference object","code":""},{"path":"/reference/version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the CDM version — version","text":"","code":"version(cdm)"},{"path":"/reference/version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the CDM version — version","text":"cdm cdm object","code":""},{"path":"/reference/version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the CDM version — version","text":"\"5.3\" \"5.4\"","code":""},{"path":"/reference/version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the CDM version — version","text":"","code":"if (FALSE) { library(CDMConnector) con <- DBI::dbConnect(duckdb::duckdb(), eunomia_dir()) cdm <- cdm_from_con(con, cdm_tables = c(tbl_group(\"default\"), \"cdm_source\")) version(cdm)  DBI::dbDisconnect(con, shutdown = TRUE) }"},{"path":"/news/index.html","id":"cdmconnector-051","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.5.1","title":"CDMConnector 0.5.1","text":"Add camelCase snake_case versions functions (@Tsemharb) Add cdm object attributes cdm_snapshot output use number_records number_subjects cohort counts table Minor bug fixes Released March 20, 2023","code":""},{"path":"/news/index.html","id":"cdmconnector-050","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.5.0","title":"CDMConnector 0.5.0","text":"CRAN release: 2023-03-09 Define generatedCohortSet class Add summarize_quantile cross database quantile queries Add GeneratedCohortSet object, constructor, attribute accessor functions Add vignette cohort generation Add cdmSubset, cdmSubsetCohort, cdmSample subsetting cdm Add cdmFlatten transforming cdm single flat table observations Improve test coverage Make Java dependency optional cdm_schema now required cdm_from_con except duckdb connections Remove visit_detail default cdm tables Deprecate computePermanent Improve package website Substantial contributions @edward-burn, @catalamarti, @Tsemharb now package co-authors. Released Mar 8, 2023","code":""},{"path":"/news/index.html","id":"cdmconnector-041","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.4.1","title":"CDMConnector 0.4.1","text":"CRAN release: 2023-01-24 Add computeQuery function creating temp persistent tables dplyr queries Download Eunomia darwin-eu repository zipped csv files Add passing tests Oracle Spark Add asDate wrapper provides correct .Date dbplyr translations Incorporate code review suggestions @mvankessel-EMC Released Jan 21, 2023","code":""},{"path":"/news/index.html","id":"cdmconnector-030","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.3.0","title":"CDMConnector 0.3.0","text":"CRAN release: 2022-11-29 Add computePermanent appendPermanent functions Add readCohortSet Add generateCohortSet Extract Eunomia dataset downloaded separately Released Nov 29, 2022","code":""},{"path":"/news/index.html","id":"cdmconnector-020","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.2.0","title":"CDMConnector 0.2.0","text":"Add support OMOP v5.3 v5.4 Add datediff dateadd functions can used dplyr::mutate() Add assert_tables function checking cdm object required tables Add camelCase versions several functions Released Nov 15, 2022","code":""},{"path":"/news/index.html","id":"cdmconnector-010","dir":"Changelog","previous_headings":"","what":"CDMConnector 0.1.0","title":"CDMConnector 0.1.0","text":"CRAN release: 2022-09-29 Initial release Sept 11, 2022 Added NEWS.md file track changes package.","code":""}]

