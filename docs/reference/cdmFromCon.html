<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a CDM reference object from a database connection — cdmFromCon • CDMConnector</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a CDM reference object from a database connection — cdmFromCon"><meta name="description" content="Create a CDM reference object from a database connection"><meta property="og:description" content="Create a CDM reference object from a database connection"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CDMConnector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a01_getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/a02_cohorts.html">Working with cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a03_dbplyr.html">CDMConnector and dbplyr</a></li>
    <li><a class="dropdown-item" href="../articles/a04_DBI_connection_examples.html">DBI connection examples</a></li>
    <li><a class="dropdown-item" href="../articles/a06_using_cdm_attributes.html">Using CDM attributes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/darwin-eu/CDMConnector/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a CDM reference object from a database connection</h1>
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/CDMConnector/blob/HEAD/R/cdm.R" class="external-link"><code>R/cdm.R</code></a></small>
      <div class="d-none name"><code>cdmFromCon.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a CDM reference object from a database connection</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cdmFromCon</span><span class="op">(</span></span>
<span>  <span class="va">con</span>,</span>
<span>  <span class="va">cdmSchema</span>,</span>
<span>  writeSchema <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cohortTables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cdmVersion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cdmName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  achillesSchema <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .softValidation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  writePrefix <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-con">con<a class="anchor" aria-label="anchor" href="#arg-con"></a></dt>
<dd><p>A DBI database connection to a database where an OMOP CDM v5.4 or
v5.3 instance is located.</p></dd>


<dt id="arg-cdmschema">cdmSchema<a class="anchor" aria-label="anchor" href="#arg-cdmschema"></a></dt>
<dd><p>The schema where the OMOP CDM tables are located. Defaults
to NULL.</p></dd>


<dt id="arg-writeschema">writeSchema<a class="anchor" aria-label="anchor" href="#arg-writeschema"></a></dt>
<dd><p>An optional schema in the CDM database that the user has
write access to.</p></dd>


<dt id="arg-cohorttables">cohortTables<a class="anchor" aria-label="anchor" href="#arg-cohorttables"></a></dt>
<dd><p>A character vector listing the cohort table names to be
included in the CDM object.</p></dd>


<dt id="arg-cdmversion">cdmVersion<a class="anchor" aria-label="anchor" href="#arg-cdmversion"></a></dt>
<dd><p>The version of the OMOP CDM. Cam be "5.3", "5.4", or NULL (default).
If NULL we will attempt to automatically determine the cdm version using
the cdm_source table and heuristics.</p></dd>


<dt id="arg-cdmname">cdmName<a class="anchor" aria-label="anchor" href="#arg-cdmname"></a></dt>
<dd><p>The name of the CDM. If NULL (default) the cdm_source_name
.  field in the CDM_SOURCE table will be used.</p></dd>


<dt id="arg-achillesschema">achillesSchema<a class="anchor" aria-label="anchor" href="#arg-achillesschema"></a></dt>
<dd><p>An optional schema in the CDM database
that contains achilles tables.</p></dd>


<dt id="arg--softvalidation">.softValidation<a class="anchor" aria-label="anchor" href="#arg--softvalidation"></a></dt>
<dd><p>Normally the observation period table should not
have overlapping observation periods for a single person. If <code>.softValidation</code> is <code>TRUE</code> the
validation check that looks for overlapping observation periods will be skipped.
Other analytic packages may break or produce incorrect results if <code>softValidation</code> is <code>TRUE</code> and
the observation period table contains overlapping observation periods.</p></dd>


<dt id="arg-writeprefix">writePrefix<a class="anchor" aria-label="anchor" href="#arg-writeprefix"></a></dt>
<dd><p>A prefix that will be added to all tables created in the write_schema. This
can be used to create namespace in your database write_schema for your tables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of dplyr database table references pointing to CDM tables</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>cdmFromCon creates a new cdm reference object from a DBI database connection.
In addition to the connection the user needs to pass in the schema in the database where the cdm data can
be found as well as another schema where the user has write access to create tables. Nearly all
downstream analytic packages need the ability to create temporary data in the database so the
write_schema is required.</p>
<p>Some database systems have the idea of a catalog or a compound schema with two components.
See examples below for how to pass in catalogs and schemas.</p>
<p>You can also specify a <code>writePrefix</code>. This is a short character string that will be added
to any tables created in the <code>writeSchema</code> effectively a namespace in the schema just for your
analysis. If the write_schema is a shared between multiple users setting a unique write_prefix
ensures you do not overwrite existing tables and allows you to easily clean up tables by
dropping all tables that start with the prefix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="eunomiaDir.html">eunomiaDir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># minimal example</span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">cdmFromCon</span><span class="op">(</span><span class="va">con</span>,</span></span>
<span class="r-in"><span>                  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span></span>
<span class="r-in"><span>                  writeSchema <span class="op">=</span> <span class="st">"scratch"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write prefix is optional but recommended if write_schema is shared</span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">cdmFromCon</span><span class="op">(</span><span class="va">con</span>,</span></span>
<span class="r-in"><span>                  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span></span>
<span class="r-in"><span>                  writeSchema <span class="op">=</span> <span class="st">"scratch"</span>,</span></span>
<span class="r-in"><span>                  writePrefix <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Some database systems use catalogs or compound schemas.</span></span></span>
<span class="r-in"><span><span class="co"># These can be specified as follows:</span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">cdmFromCon</span><span class="op">(</span><span class="va">con</span>,</span></span>
<span class="r-in"><span>                  cdmSchema <span class="op">=</span> <span class="st">"catalog.main"</span>,</span></span>
<span class="r-in"><span>                  writeSchema <span class="op">=</span> <span class="st">"catalog.scratch"</span>,</span></span>
<span class="r-in"><span>                  writePrefix <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">cdmFromCon</span><span class="op">(</span><span class="va">con</span>,</span></span>
<span class="r-in"><span>                  cdmSchema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"my_catalog"</span>, <span class="st">"main"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  writeSchema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"my_catalog"</span>, <span class="st">"scratch"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  writePrefix <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">cdmFromCon</span><span class="op">(</span><span class="va">con</span>,</span></span>
<span class="r-in"><span>                  cdmSchema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>catalog <span class="op">=</span> <span class="st">"my_catalog"</span>, schema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  writeSchema <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>catalog <span class="op">=</span> <span class="st">"my_catalog"</span>, schema <span class="op">=</span> <span class="st">"scratch"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  writePrefix <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Black, Artem Gorbachev, Edward Burn, Marti Catala Sabate, Ioanna Nika.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

